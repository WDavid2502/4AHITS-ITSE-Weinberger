# ITSE Arbeitsbericht
## Meta Informationen
Klasse: 4AHITS  
Name: David Weinberger   
Fach: ITSE-Labor   
Datum: 20.10.2025     

## Übung (ping)

### Angabe
Als host discovery (host scanning) versteht man den Vorgang um unbekannte Geräte in einem Netzwerk zu finden, bzw. festzustellen ob bekannte Geräte im Netzwerk erreichbar sind.

Das einfachste Werkzeug dafür ist ping.

Verwende Kali und Metasploitable im Bridged Mode (Bridge ins Labor-Netzwerk)
Experimentiere mit ping im Labor-Netzwerk (Metasploitable, Default Gateway, …)
Recherchiere zu den Optionen von ping, erstelle ein kleines Cheat Sheet
Welchen Netzwerkdienst verwendet der ping Dienst? Recherchiere wie Firewalls häufig mit ping umgehen.

### Firewalls Recherche

Firewalls blockieren Ping‑Anfragen oft ganz oder teilweise, damit Rechner von außen schwer zu sehen sind. Manche begrenzen die Anzahl der Pings pro Sekunde, andere lassen nur Antworten zu, die zu erlaubten Verbindungen passen. So sollen Rechner geschützt werden, ohne wichtige Netzwerkfunktionen zu stören.

### Ping Recherche

Der ping‑Befehl benutzt das ICMP‑Protokoll. Dabei werden Nachrichten geschickt, die prüfen, ob ein anderer Rechner im Netz erreichbar ist, ohne Ports wie bei TCP oder UDP zu benutzen.

### Linux Ping Cheat Sheet

- c <count> — Anzahl Requests 

- i <interval> — Sekunden zwischen Paketen 

- s <size> — Payload-Größe in Bytes

- W <timeout> — Timeout pro Reply in Sekunden

- w <deadline> — Gesamttimeout in Sekunden

- n — keine Namensauflösung

- q — nur Summary ausgeben

- f — flood (root, sehr vorsichtig)

- 4 / -6 — IPv4 / IPv6 erzwingen
 
 
### Windows Ping Cheat Sheet

-n <count>, -l <size>, -w <timeout-ms>, -t (endlos)
 
## Übung (ping Script)

### Angabe
Schreibe ein shell Skript das automatisiert (Schleife) alle Hosts im subnet anpingt. Die Ausgabe soll so sein, dass man daraus die aktiven Hosts erkennen kann (für nicht aktive Hosts soll keine Ausgabe sein).

### Code
```
!/bin/bash

for((i=1; i < 255;i++)); do

        ip=192.168.15.$i

                 timeout 0.05 ping -c1 $ip > /dev/null 2>&1

        if [ $? -eq 0 ]; then
        echo "$ip ist erreichbar"
        fi

done
```

### Erklärung

```for((i=1; i < 255;i++)); do
 ip=192.168.15.$i
```
Die Schleife zählt von 1 weg bis 254 (weil nur Hosts im jeweiligen Subnet gepingt werden sollen).
Dann erfolgt die Ip Zuweisung, in meinem Fall ist das Subnet 15. 

```
timeout 0.05 ping -c1 $ip > /dev/null 2>&1
```
Den Befehl timeout verwendet man dafür dass er nur 50ms lang den ping probiert, danach bricht er ab und zählt die Schleife weiter, sonst würde er 1 Sekunde pro Ping brauchen, was sehr lange ist bei 254 pings. 
Das -c1 bedeutet nur ein einziges ICMP-Echo-Paket (Ping) wird gesendet.
Das ```> /dev/null 2>&1 ``` bedeutet dass die Standartausgaben direkt ins nichts weitergeleitet wird, da dann sowieso eine eigene echo Ausgabe folgt.



```
 if [ $? -eq 0 ]; then
        echo "$ip ist erreichbar"
        fi
```
Das ```$?``` ist das zuletzt übergebene Argument. 
Das ```-eq 0``` prüft ob der letzte Exit-Code gleich 0 ist, wenn ja dann kommt man in das if rein.
Im if wird dann ausgegeben dass diese Ip erfolgreich gepingt wurde, wenn nicht wird gar nichts ausgegeben und einfach die nächste Ip genommen.

## Übung (host discovery)

### Angabe
nmap ist ein Tool zum network scanning. In einer ersten Phase (host discovery, ping scan oder ping sweep) ermittelt nmap alle aktiven Hosts.

Aufgaben:

Recherchiere zur grundlegenden Anwendung von nmap für einen sogenannten ping scan (host discovery).
Ermittle alle aktiven Hosts im Subnetz des Labor-Netzwerks mit nmap.
Hinweise:

nmap benötigt als Argument den IP Adressbereich des Subnet in Präfix Notation (z.B.: 192.168.178.0/24)
Mit der Option -sn führt nmap nur den ping scan durch (ansonsten wird automtisch auch die nächste, länger dauernde, Phase des scans ausgeführt – siehe folgende Übung)


### Recherche zu Nmap

Nmap ist ein Kommandozeilen‑Tool zum Auffinden von Hosts und zum Scannen von Netzwerkdiensten. Ein Ping‑Scan (Host‑Discovery) in Nmap wird mit der Option `-sn` ausgeführt und ermittelt nur welche Hosts im Zielnetz „up“ sind, ohne Ports zu scannen. Als Root im lokalen LAN nutzt es ARP‑Requests (sehr zuverlässig), sonst ICMP‑, TCP‑SYN/ACK‑ oder UDP‑Probes, die von Firewalls geblockt werden können. Die Ausgabe meldet für gefundene Geräte typischerweise „Host is up“ und liefert bei ARP‑Erkennung zusätzlich MAC‑Adressen und Vendor‑Infos.

### Recherche zu Erweiterungen von Nmap

-sS — Führt einen TCP‑SYN‑Scan (halboffener Scan) durch, der schnell Ports erkundet, ohne vollständige Verbindungen aufzubauen.

-sU — Scannt UDP‑Ports, um auf UDP‑Dienste zu prüfen (langsamer und fehleranfälliger wegen fehlender Antworten).

-p <ports> — Gibt explizit welche Ports oder Port‑Bereiche gescannt werden sollen (z. B. -p 1-1024,80,443).

-A — Aktiviert aggressive Erkennung (OS‑Fingerprinting, Service‑Versionen, NSE‑Skripte und Traceroute) für umfassende Informationen.

-O — Versucht das Betriebssystem des Ziels zu erkennen anhand charakteristischer Netzwerkantworten.

-Pn — Überspringt die Host‑Discovery und behandelt alle Ziele als „up“.

-oA <prefix> — Speichert die Ergebnisse simultan in allen drei Formaten (.nmap, .gnmap, .xml) unter dem angegebenen Prefix zur späteren Analyse.


### Ermittlung aller aktiven Hosts

Labornetz: 15   

Befehl:

`sudo nmap -sn 192.168.15.0/24`

#### Ausgabe des Laborrechners

```
[sudo] password for kali: 
Starting Nmap 7.95 ( https://nmap.org ) at 2025-10-20 06:59 EDT
Nmap scan report for 192.168.15.51
Host is up (0.00041s latency).
MAC Address: 74:86:E2:30:3E:F7 (Dell)
Nmap scan report for 192.168.15.254
Host is up (0.00060s latency).
MAC Address: 1C:DF:0F:CA:41:01 (Cisco Systems)
Nmap scan report for 192.168.15.52
Host is up.
Nmap done: 256 IP addresses (3 hosts up) scanned in 2.37 seconds
```
#### Erklärung

Es sind 3 Hosts up und dazu gibt es auch noch die Mac Address aus und fügt die Ip Address hinzu.

## Übung (Alternativen)

### Angabe

Recherchiere zu Alternativen für das Host Discovery. D.h. für den Fall, dass kein ping oder nmap zur Verfügung steht.

### Recherche für Alternativen für Host Discovery

-sn – damit fragt Nmap nur ab, welche Rechner im Netz an sind; es macht keine Port‑Prüfungen. Wenn ein Rechner antwortet, steht er auf der Liste „online“, sonst nicht. Nutze das, wenn du schnell wissen willst, wer überhaupt reagiert.

-PE – Nmap schickt den normalen Ping an die Rechner und wartet auf die Antwort. Das klappt gut, wenn Pings im Netz erlaubt sind. Wenn Pings blockiert sind, fehlen aber einige Geräte in der Liste.

-PP – Nmap schickt statt des normalen Pings eine Zeitstempel‑Anfrage und wartet auf die Antwort. Manche Geräte reagieren darauf, auch wenn sie normalen Ping blocken. Es ist eine alternative Art zu prüfen, ob ein Rechner da ist.

-PM – Nmap fragt per ICMP nach der Netzmaske des Ziels; das ist eine weitere Variante von Ping. Manche Geräte geben darauf eine Antwort, andere nicht. Man benutzt das, um noch mehr Geräte zu erwischen, wenn Echo nicht hilft.

-PS – Nmap schickt kurze Verbindungsanforderungen an bestimmte TCP‑Ports (z. B. zu Port 22 oder 80) und schaut, ob eine Antwort kommt. Das ist nützlich, wenn ICMP gesperrt ist, aber normale Dienste erreichbar sind. Achtung: das ist auffälliger und kann in Logs landen.

-PA – Nmap schickt ACK‑Pakete an bestimmte TCP‑Ports und wertet die Reaktion aus. Das kann Hosts zeigen, die auf SYN nicht reagieren oder wo Firewalls anders filtern. Es ist eine Ergänzung zu -PS, um verschiedene Firewall‑Verhalten zu testen.

-PR – Nmap nutzt ARP‑Anfragen auf dem lokalen Netz und findet so Rechner sehr zuverlässig, auch wenn Firewalls Pings blocken. Das funktioniert nur im gleichen lokalen Netzwerk und braucht oft erhöhte Rechte (sudo). Verwende das, wenn du auf dem LAN genau wissen willst, wer da ist.

## Übung (Firewall)

### Angabe

Recherchiere welche Verteidigungsmöglichkeiten es gegen einen Ping Scan gibt wenn dieser mit dem ping Tool ausgeführt werden sollte. Wie könnte ein Angreifer dies wiederum umgehen.

### Recherche

1. ICMP‑Ping blockieren oder nur gezielt erlauben.
Dadurch sind Rechner von außen mit einfachem Ping oft nicht sichtbar. Angreifer könnten statt ICMP andere Protokolle nutzen, deshalb zusätzlich andere Erkennungswege überwachen.

2. Antwort‑Rate für Pings begrenzen (Rate‑Limit).
Schnelle Massen‑Scans werden dadurch sehr langsam und fallen eher auf. Ein Angreifer könnte langsamer scannen; deswegen auch Langzeit‑Muster und wiederholte Anfragen protokollieren.

3. Stateful‑Firewall einsetzen, die nur legitime Antworten durchlässt.
Nur Verbindungen, die zuvor aufgebaut wurden, erlauben Antworten, einfache Pings werden ignoriert. Angreifer könnten gezielte Port‑Anfragen senden; daher auch Zugriffsregeln für übliche Dienste kontrollieren und alarmieren.

4. IP‑Spoofing am Netzrand verhindern (Ingress/Egress‑Filter).
Gefälschte Absender‑IP werden vom Router verworfen, damit werden getarnte Pings schwerer. Angreifer könnten über fremde Rechner oder Tunnel arbeiten; deshalb Logs correlieren und ungewöhnliche Pfade untersuchen.

5. Interne Rechner hinter NAT/ACL verstecken und nur nötige Dienste freigeben.
So sind nur explizit freigegebene Ziele von außen sichtbar. Falls Angreifer legitime Dienste ansprechen, helfen starke Zugangskontrollen und Monitoring, ungewöhnliche Nutzung zu entdecken.


