# ITSE Arbeitsbericht vsFTP Backdoor

## Meta Informationen
Klasse: 4AHITS  
Name: David Weinberger   
Fach: ITSE-Labor   
Datum: 23.02.2026


# Übung (msf Basics)

## Angabe
Probiere alle besprochenen bzw. open beschriebenen msf Befehle noch einmal aus und erstelle ein kurzes Cheatsheet zur Bedienung von metasploit.

Der Befehl setg (set global) ist in unserem Zusammenhang auch sehr praktisch, recherchiere dazu.
Recherchiere zu:
msfvenom
Meterpreter
## Lösung
### search -h
```bash
search -h
```
Zeigt die Hilfe zur search-Funktion an.  

### search ssh
```bash
search ssh
```
Durchsucht alle verfügbaren Module nach dem Begriff ssh.


### search scanner/ssh
```bash
search scanner/ssh
```
Sucht gezielt nach Modulen im Verzeichnis scanner/ssh.


### search type:auxiliary name:ssh
```bash
search type:auxiliary name:ssh
```
Filtert die Suche nach Modultyp auxiliary und dem Begriff ssh im Namen.


### info auxiliary/scanner/ssh/ssh_version
```bash
info auxiliary/scanner/ssh/ssh_version
```
Zeigt detaillierte Informationen über dieses Modul an, z. B. Beschreibung, Optionen und Referenzen.


### use auxiliary/scanner/ssh/ssh_version
```bash
use auxiliary/scanner/ssh/ssh_version
```
Lädt das Modul, damit es konfiguriert und ausgeführt werden kann.


### options
```bash
options
```
Zeigt alle einstellbaren Parameter des aktuell geladenen Moduls an.

### set RHOSTS <target IP>
```bash
set RHOSTS 192.168.1.10
```
Setzt die Zieladresse.  
RHOSTS kann eine einzelne IP, mehrere IPs oder ein ganzes Netzwerk sein.


### run
```bash
run
```
Führt das aktuell geladene Modul mit den gesetzten Optionen aus.


## HTTP Title – Verwendete Befehle

### use auxiliary/scanner/http/title
```bash
use auxiliary/scanner/http/title
```
Lädt das HTTP-Title-Scanner-Modul. Dieses liest den Titel einer Webseite aus.


### info
```bash
info
```
Zeigt Informationen zum aktuell geladenen Modul an.

### options
```bash
options
```
Zeigt die konfigurierbaren Optionen des HTTP-Moduls an.


### set RHOSTS <target IP>
```bash
set RHOSTS 192.168.1.10
```
Setzt die Zieladresse für den HTTP-Scan.


### run
```bash
run
```
Startet den HTTP-Scan.

### set RHOSTS www.orf.at
```bash
set RHOSTS www.orf.at
run
```
Setzt die Ziel-Domain auf www.orf.at und führt den Scan aus.

### set RHOSTS www.htl-braunau.at
```bash
set RHOSTS www.htl-braunau.at
run
```
Setzt die Ziel-Domain auf www.htl-braunau.at und führt den Scan aus.



## Recherche zu setg, msfvenom und Meterpreter

## setg (set global)

Der Befehl `setg` setzt eine Variable global in der msfconsole.  
Die gesetzte Option gilt für alle Module innerhalb der aktuellen Sitzung.

Syntax:
```bash
setg <OPTION> <WERT>
```

Beispiel:
```bash
setg LHOST 192.168.1.100
setg LPORT 4444
```

## msfvenom

msfvenom ist ein Tool zur Erstellung von Payload-Dateien (z. B. exe, elf).

Normale syntax:
```bash
msfvenom -p <PAYLOAD> LHOST=<IP> LPORT=<PORT> -f <FORMAT> -o <DATEI>
```

Parameter:
 `-p` → Payload     
 `LHOST` → Angreifer-IP      
 `LPORT` → Port     


## Meterpreter

Meterpreter ist eine erweiterte Metasploit-Payload für Post-Exploitation.  

Wichtige Befehle:
```bash
sysinfo
getuid
```

# Übung (nmap FTP scan)
## Angabe
Aufgabe: Wiederhole den nmap vuln scan auf den FTP Port. Verwende:

Option --script=vuln (Diese Skripte sind “intrusive” und werden daher nicht über die Optionen -sC oder -A aufgerufen.)

Option -p zum Einschränken auf den FTP Port

Findet nmap die Sicherheitslücke? Recherchiere mit Hilfe der CVE Nummer über diese Sicherheitslücke.

Recherchiere warum diese Skripte als intrusive bezeichnet werden, warum werden diese bei -sC oder -A nicht ausgeführt?

## Lösung

### Scan-Befehl

FTP läuft standardmäßig auf Port 21.

```bash
nmap --script=vuln -p 21 <target IP>
```
In meinem Fall
```bash
nmap --script=vuln -p 21 192.168.96.131
```


Erklärung:
 `--script=vuln` → Führt alle NSE-Skripte der Kategorie „vuln“ aus.     
 `-p 21` → Beschränkt den Scan auf den FTP-Port, wie oben bereits geschrieben.        
 `<target IP>` → Zielsystem.    

### Findet nmap eine Sicherheitslücke?

Ja, und zwar "CVE-2011-2523" diese betrifft:
vsFTPd 2.3.4

### CVE-2011-2523 – Erklärung

Diese Sicherheitslücke betrifft den FTP-Server vsFTPd 2.3.4.

In dieser Version wurde eine versteckte Hintertür (Backdoor) eingebaut.

Wenn sich jemand mit einem Benutzernamen anmeldet, der :) enthält, öffnet der Server heimlich eine zusätzliche Verbindung auf Port 6200.

Dadurch bekommt der Angreifer eine Shell und kann Befehle auf dem Server ausführen, das ist gefährlich, weil man so direkten Zugriff auf das System bekommen kann.

### Warum sind vuln-Skripte „intrusive“?

Die NSE-Skripte sind in Kategorien eingeteilt.

Kategorie „vuln“:
 Testet aktiv auf bekannte Sicherheitslücken.    
 Führt teilweise Exploit-ähnliche Tests durch.      
 Kann Dienste zum Absturz bringen.      

Warum nicht bei -sC oder -A?

Optionen:
 `-sC` → Führt nur „default“-Skripte aus.     
 `-A` → Aktiviert OS-Detection, Version-Scan und Default-Skripte.    

Intrusive Skripte werden nicht automatisch ausgeführt, weil sie zum Beispiel Systeme beeinträchtigen können.    


Darum muss `--script=vuln` explizit angegeben werden.
